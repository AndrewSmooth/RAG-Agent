{
  "question": "Проанализируй использование основных средств: рассчитай коэффициент использования оборудования, износ активов по категориям, расходы на обслуживание и остаточную стоимость",
  "sql": "SELECT a.category, COUNT(*) as total_assets, ROUND(AVG(CASE WHEN a.status = 'in_operation' THEN 1 ELSE 0 END) * 100, 2) as utilization_rate_percent, ROUND(AVG((a.acquisition_cost - a.depreciated_value) / a.acquisition_cost * 100), 2) as avg_depreciation_percent, ROUND(AVG(a.depreciated_value / a.acquisition_cost * 100), 2) as avg_residual_value_percent, SUM(a.acquisition_cost) as total_acquisition_cost, SUM(a.depreciated_value) as total_depreciated_value, SUM(a.acquisition_cost - a.depreciated_value) as total_residual_value, SUM(COALESCE(mr.cost, 0)) as total_maintenance_cost, ROUND(SUM(COALESCE(mr.cost, 0)) / COUNT(*), 2) as avg_maintenance_cost_per_asset FROM assets a LEFT JOIN maintenance_records mr ON a.id = mr.asset_id AND mr.maintenance_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY a.category ORDER BY total_acquisition_cost DESC;"
}