{
  "question": "Создай сводный отчет по производственному графику на следующий месяц, включая все производственные заказы, их статус, запланированные и фактические даты начала и окончания, а также ответственных сотрудников",
  "sql": "SELECT bo.id as order_id, p.name as product, pl.name as production_line, bo.quantity as planned_quantity, bo.status, bo.planned_start_date, bo.planned_end_date, bo.actual_start_date, bo.actual_end_date, DATEDIFF(COALESCE(bo.actual_end_date, CURDATE()), bo.planned_start_date) as actual_duration_days, DATEDIFF(bo.planned_end_date, bo.planned_start_date) as planned_duration_days, e.name as responsible_employee, CASE WHEN bo.status = 'completed' AND bo.actual_end_date <= bo.planned_end_date THEN 'On Time' WHEN bo.status = 'completed' AND bo.actual_end_date > bo.planned_end_date THEN 'Delayed' WHEN bo.status = 'in_progress' AND CURDATE() > bo.planned_end_date THEN 'Behind Schedule' ELSE 'On Schedule' END as schedule_status FROM production_orders bo JOIN products p ON bo.product_id = p.id JOIN production_lines pl ON bo.production_line_id = pl.id JOIN employees e ON bo.responsible_employee_id = e.id WHERE bo.planned_start_date BETWEEN CURDATE() AND DATE_ADD(CURDATE(), INTERVAL 1 MONTH) OR bo.status IN ('in_progress', 'completed') AND bo.planned_start_date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) ORDER BY bo.planned_start_date, pl.name;"
}