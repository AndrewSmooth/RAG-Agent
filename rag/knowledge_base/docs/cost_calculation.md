# Калькуляция себестоимости продукции

## Определение
Калькуляция себестоимости — это процесс определения полной стоимости производства единицы продукции. Точная калькуляция необходима для установления цен, анализа рентабельности, принятия управленческих решений и контроля затрат.

## Компоненты себестоимости
Себестоимость продукции состоит из следующих основных компонентов:

### 1. Прямые материальные затраты (Direct Material Cost)
- Стоимость основных материалов, входящих в состав продукции
- Рассчитывается на основе спецификации материала (BOM)
- Включает стоимость сырья, компонентов, упаковки

### 2. Прямые трудовые затраты (Direct Labor Cost)
- Затраты на оплату труда производственного персонала
- Рассчитывается на основе нормативного времени и ставки оплаты труда
- Включает основную и дополнительную заработную плату

### 3. Общепроизводственные расходы (Overhead)
- Косвенные затраты, связанные с производством
- Не могут быть напрямую отнесены к конкретному продукту
- Распределяются по продукции по определенным базам

## Методы калькуляции
### 1. Метод полных затрат (Absorption Costing)
- Включает все производственные затраты (прямые и косвенные)
- Общепроизводственные расходы распределяются по продукции
- Используется для внешней отчетности и налогообложения

### 2. Метод переменных затрат (Variable Costing)
- Включает только переменные производственные затраты
- Постоянные общепроизводственные расходы не включаются в себестоимость
- Используется для внутреннего управления и принятия решений

### 3. Метод стандарт-кост (Standard Costing)
- Использует нормативные (стандартные) затраты
- Сравнивает фактические и нормативные затраты
- Позволяет выявлять отклонения и управлять ими

### 4. Метод ABC (Activity-Based Costing)
- Распределяет косвенные затраты на основе деятельности
- Более точное распределение затрат
- Учитывает различные факторы, влияющие на затраты

## Процесс калькуляции
1. **Сбор данных**
   - Получение актуальной спецификации материала из таблицы [`bom`](rag/knowledge_base/docs/bom.md:1)
   - Получение нормативного времени операций из таблицы [`operation`](rag/knowledge_base/docs/operation.md:1)
   - Получение данных о стоимости материалов и труда

2. **Расчет прямых материальных затрат**
   ```
   Прямые материальные затраты = Σ (Количество компонента × Стоимость компонента)
   ```
   - Для каждого компонента из [`bom_component`](rag/knowledge_base/docs/bom_component.md:1)
   - С учетом коэффициента потерь (scrap_factor)

3. **Расчет прямых трудовых затрат**
   ```
   Прямые трудовые затраты = Σ (Нормативное время операции × Ставка оплаты труда)
   ```
   - Для каждой операции в маршруте [`routing`](rag/knowledge_base/docs/routing.md:1)
   - С учетом времени наладки и переналадки

4. **Распределение общепроизводственных расходов**
   - Определение базы распределения (машино-часы, трудо-часы, прямые затраты)
   - Расчет ставки распределения:
     ```
     Ставка распределения = Общие общепроизводственные расходы / Общая база распределения
     ```
   - Распределение расходов на продукцию:
     ```
     Общепроизводственные расходы на продукт = Ставка распределения × База распределения для продукта
     ```

5. **Расчет полной себестоимости**
   ```
   Полная себестоимость = Прямые материальные затраты + Прямые трудовые затраты + Общепроизводственные расходы
   ```

## Пример калькуляции
Для продукта А:
1. **Прямые материальные затраты**:
   - Компонент B: 2 единицы × 50 руб. = 100 руб.
   - Компонент C: 3 единицы × 30 руб. = 90 руб.
   - Упаковка: 1 единица × 20 руб. = 20 руб.
   - Итого: 210 руб.

2. **Прямые трудовые затраты**:
   - Операция 1: 10 минут × 300 руб./час = 50 руб.
   - Операция 2: 15 минут × 300 руб./час = 75 руб.
   - Итого: 125 руб.

3. **Общепроизводственные расходы**:
   - База распределения: машино-часы = 25 минут = 0.417 часа
   - Ставка распределения: 1000 руб./час
   - Общепроизводственные расходы: 0.417 × 1000 = 417 руб.

4. **Полная себестоимость**:
   - 210 + 125 + 417 = 752 руб.

## Применение в системе
Наша ERP-система автоматизирует процесс калькуляции себестоимости:

### 1. Автоматический сбор данных
- Спецификация материала из [`bom`](rag/knowledge_base/docs/bom.md:1) и [`bom_component`](rag/knowledge_base/docs/bom_component.md:1)
- Маршрут производства из [`routing`](rag/knowledge_base/docs/routing.md:1) и [`operation`](rag/knowledge_base/docs/operation.md:1)
- Стоимость материалов из [`inventory`](rag/knowledge_base/docs/inventory.md:1) (предполагаемая)
- Ставки оплаты труда из [`salary_structure`](rag/knowledge_base/docs/salary_structure.md:1)

### 2. Расчет нормативной себестоимости
- Автоматический расчет при создании новой спецификации
- Обновление при изменениях в BOM или маршруте
- Хранение истории изменений себестоимости

### 3. Расчет фактической себестоимости
- На основе фактических данных из [`production_order`](rag/knowledge_base/docs/production_order.md:1)
- Сравнение с нормативной себестоимостью
- Анализ отклонений

### 4. Анализ и отчетность
- Сравнение себестоимости по разным продуктам
- Анализ структуры себестоимости
- Выявление наиболее затратных компонентов
- Прогнозирование себестоимости при изменениях цен

## Показатели эффективности
- **Отклонение себестоимости** = (Фактическая себестоимость - Нормативная себестоимость) / Нормативная себестоимость × 100%
- **Доля материалов в себестоимости** = Прямые материальные затраты / Полная себестоимость × 100%
- **Доля труда в себестоимости** = Прямые трудовые затраты / Полная себестоимость × 100%
- **Доля общепроизводственных расходов** = Общепроизводственные расходы / Полная себестоимость × 100%

## Непрерывное улучшение
Система поддерживает постоянную оптимизацию себестоимости:
- Анализ отклонений и выявление причин
- Поиск альтернативных материалов с лучшим соотношением цена/качество
- Оптимизация производственных процессов для снижения трудозатрат
- Пересмотр нормативов при технологических улучшениях