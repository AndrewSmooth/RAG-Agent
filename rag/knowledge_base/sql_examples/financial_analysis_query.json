{
  "question": "Выполни комплексный финансовый анализ за последний год: рассчитай прибыльность по продуктам, рентабельность активов, коэффициент текущей ликвидности и анализируй структуру затрат",
  "sql": "SELECT p.name as product, p.selling_price, ROUND(b.material_cost_per_unit + b.labor_cost_per_unit + b.overhead_cost_per_unit, 2) as unit_cost, ROUND(p.selling_price - (b.material_cost_per_unit + b.labor_cost_per_unit + b.overhead_cost_per_unit), 2) as gross_profit_per_unit, ROUND((p.selling_price - (b.material_cost_per_unit + b.labor_cost_per_unit + b.overhead_cost_per_unit)) / p.selling_price * 100, 2) as gross_margin_percent, SUM(bo.quantity) as total_units_sold, SUM(bo.quantity * p.selling_price) as total_revenue, SUM(bo.quantity * (b.material_cost_per_unit + b.labor_cost_per_unit + b.overhead_cost_per_unit)) as total_cost, SUM(bo.quantity * (p.selling_price - (b.material_cost_per_unit + b.labor_cost_per_unit + b.overhead_cost_per_unit))) as total_gross_profit, ROUND(SUM(bo.quantity * (p.selling_price - (b.material_cost_per_unit + b.labor_cost_per_unit + b.overhead_cost_per_unit))) / (SELECT SUM(value) FROM fixed_assets WHERE status = 'active'), 4) as roa, ROUND((SELECT SUM(amount) FROM current_assets) / (SELECT SUM(amount) FROM current_liabilities), 2) as current_ratio FROM products p JOIN bill_of_materials b ON p.id = b.product_id JOIN production_orders bo ON p.id = bo.product_id WHERE bo.planned_start_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY p.id, p.name, p.selling_price, b.material_cost_per_unit, b.labor_cost_per_unit, b.overhead_cost_per_unit ORDER BY total_gross_profit DESC;"
}