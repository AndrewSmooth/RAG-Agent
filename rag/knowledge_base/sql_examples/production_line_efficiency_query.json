{
  "question": "Проанализируй эффективность производственных линий по коэффициенту OEE (Overall Equipment Effectiveness)",
  "sql": "SELECT pl.name as production_line, pl.efficiency_rate, AVG(mr.downtime_hours) as avg_downtime, SUM(wo.actual_labor_hours) as total_labor_hours, ROUND((SUM(wo.actual_duration_hours) / SUM(wo.planned_duration_hours)) * 100, 2) as performance_rate, COUNT(CASE WHEN wo.quality_checks_passed = true THEN 1 END) * 100.0 / COUNT(*) as quality_rate, ROUND(pl.efficiency_rate * (SUM(wo.actual_duration_hours) / SUM(wo.planned_duration_hours)) * (COUNT(CASE WHEN wo.quality_checks_passed = true THEN 1 END) * 100.0 / COUNT(*) / 100), 2) as calculated_oee FROM production_lines pl JOIN work_orders wo ON pl.id = wo.production_line_id JOIN maintenance_records mr ON pl.id = mr.production_line_id WHERE wo.status = 'completed' AND mr.start_date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) GROUP BY pl.id, pl.name, pl.efficiency_rate ORDER BY calculated_oee DESC;"
}