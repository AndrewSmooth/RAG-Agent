{
  "question": "Проанализируй эффективность отдела продаж за последний квартал: рассчитай выполнение плана продаж, средний размер заказа, конверсию лидов в сделки и прибыльность клиентов",
  "sql": "SELECT s.name as sales_representative, COUNT(DISTINCT l.id) as total_leads, COUNT(DISTINCT o.id) as closed_deals, ROUND(COUNT(DISTINCT o.id) * 100.0 / COUNT(DISTINCT l.id), 2) as lead_conversion_rate_percent, SUM(o.total_amount) as total_revenue, AVG(o.total_amount) as average_order_value, SUM(o.total_amount) / (SELECT SUM(target_amount) FROM sales_targets st WHERE st.period_start >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH) AND st.sales_rep_id = s.id) as sales_target_achievement_ratio, SUM(o.total_amount - o.cost_of_goods_sold) as total_gross_profit, ROUND(AVG(c.profitability_score), 2) as avg_customer_profitability_score FROM sales_representatives s LEFT JOIN leads l ON s.id = l.assigned_to AND l.created_date >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH) LEFT JOIN orders o ON s.id = o.sales_rep_id AND o.order_date >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH) LEFT JOIN customers c ON o.customer_id = c.id WHERE s.status = 'active' GROUP BY s.id, s.name ORDER BY total_revenue DESC;"
}